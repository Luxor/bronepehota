# Feature Specification: Show Unit Details in Army Builder

**Feature Branch**: `001-show-unit-details`
**Created**: 2025-01-04
**Status**: Draft
**Input**: User description: "При формировании армии и выборе подразделений, у пользователя должна быть возможность просмотреть характеристики отряда для того чтобы сделать осознанный выбор"

## Clarifications

### Session 2025-01-04

- Q: Как пользователь открывает модальное окно - по наведению (hover) или по клику? → A: Click/tap only - modal opens only on click or tap, no hover trigger
- Q: Какой тип UI компонента использовать? → A: Modal dialog - центрированное оверлей, блокирующее фоновое взаимодействие
- Q: Как сравнивать несколько юнитов - несколько модалов одновременно или переключение содержимого? → A: Content switching - нажатие на другой юнит обновляет содержимое текущего модального окна
- Q: Как работает навигация с клавиатуры в модальном окне? → A: Full focus trap - Tab циклически переключает фокус внутри модального окна, Escape закрывает
- Q: Где должна находиться кнопка закрытия модального окна? → A: Top-right corner - в заголовке модального окна, всегда видна при прокрутке

---

## User Scenarios & Testing *(mandatory)*

### User Story 1 - View Squad Soldier Details (Priority: P1)

Игрок просматривает/army builder и видит список доступных отрядов. При наведении или клике на отряд, игрок может увидеть детальную информацию о каждом солдате в отряде: ранг, скорость, дистанцию атаки, мощность, бой, защиту и особые свойства.

**Why this priority**: Это критически важная функциональность для принятия осознанных решений при формировании армии. Без возможности увидеть характеристики солдата, игрок не может оценить полезность отряда и сделать информированный выбор.

**Independent Test**: Может быть полностью протестировано путем: выбора фракции → просмотра списка отрядов → открытия деталей любого отряда → проверки отображения всех характеристик всех солдат в отряде. Пользователь получает полную информацию для принятия решения без необходимости добавлять отряд в армию.

**Acceptance Scenarios**:

1. **Given** игрок на экране выбора отрядов, **When** игрок нажимает/тапает на карточку отряда, **Then** отображается модальное окно со списком всех солдат отряда и их характеристиками
2. **Given** открыто окно с деталями отряда, **When** отряд содержит 6 солдат, **Then** отображаются все 6 солдат с их полными характеристиками (ранг, скорость, атака, мощь, бой, защита, свойства)
3. **Given** открыто окно с деталями отряда, **When** у солдата есть особое свойство (например, "Г" - граната), **Then** свойство отображается с визуальным выделением и всплывающей подсказкой
4. **Given** открыто окно с деталями отряда, **When** у солдата есть изображение, **Then** изображение отображается рядом с характеристиками

---

### User Story 2 - View Machine Weapon and Durability Details (Priority: P1)

Игрок просматривает список доступной техники (машин). При взаимодействии с карточкой машины, игрок видит детальную информацию: ранг, скорострельность, боезапас, прочность, скоростные сектора и все вооружения с их характеристиками.

**Why this priority**: Техника является ключевым элементом армии и имеет сложную структуру характеристик. Без детального просмотра вооружения и скоростных секторов игрок не может оценить тактические возможности машины и сравнить её с другими юнитами.

**Independent Test**: Может быть полностью протестировано путем: выбора фракции → просмотра списка машин → открытия деталей любой машины → проверки отображения всех вооружений, скоростных секторов и характеристик машины. Пользователь получает полную информацию о машине без добавления её в армию.

**Acceptance Scenarios**:

1. **Given** игрок на экране выбора техники, **When** игрок нажимает/тапает на карточку машины, **Then** отображается модальное окно с характеристиками машины
2. **Given** открыто окно с деталями машины, **When** машина имеет 3 оружия, **Then** отображаются все 3 оружия с их названиями, дальностью, мощностью и особыми свойствами
3. **Given** открыто окно с деталями машины, **When** машина имеет скоростные сектора, **Then** отображается таблица/схема секторов с диапазонами прочности и соответствующей скоростью
4. **Given** открыто окно с деталями машины, **When** у машины есть изображение, **Then** изображение отображается в верхней части модального окна

---

### User Story 3 - Compare Units Side by Side (Priority: P2)

Игрок хочет сравнить два или более отряда/машины перед принятием решения. Игрок может переключаться между юнитами без закрытия модального окна - нажатие на карточку другого юнита обновляет содержимое модального окна.

**Why this priority**: Сравнение позволяет игроку сделать более осознанный выбор при ограниченном бюджете очков. Это улучшающая, но не критичная функциональность - без неё игрок всё равно может просматривать детали по очереди.

**Independent Test**: Может быть полностью протестировано путем: открытия деталей первого юнита → нажатия на карточку второго юнита → проверки обновления содержимого модального окна.

**Acceptance Scenarios**:

1. **Given** открыто окно с деталями первого юнита, **When** игрок нажимает на карточку второго юнита, **Then** окно деталей обновляется с информацией второго юнита
2. **Given** открыто окно с деталями, **When** игрок закрывает окно деталей, **Then** отображается исходный экран выбора юнитов с предыдущим состоянием (фильтры, поиск, список выбранных)

---

### User Story 4 - Mobile-Optimized Unit Details View (Priority: P2)

Игрок использует мобильное устройство для формирования армии. При открытии деталей юнита, информация адаптивно отображается на маленьком экране с возможностью прокрутки и закрытия одним касанием.

**Why this priority**: Мобильные пользователи составляют значительную часть аудитории. Неудобный просмотр деталей на мобильном устройстве снижает юзабилити, но базовая функциональность (Story 1 и 2) работает и на мобильных.

**Independent Test**: Может быть протестировано путем: открытия приложения на мобильном устройстве/эмуляторе → открытия деталей юнита → проверки читаемости текста, размера touch-элементов, возможности прокрутки и закрытия.

**Acceptance Scenarios**:

1. **Given** игрок на мобильном устройстве, **When** открываются детали отряда с 6 солдатами, **Then** информация прокручивается вертикально, все характеристики читаемы, кнопка закрытия доступна и имеет минимум 44x44px
2. **Given** детали юнита открыты на мобильном, **When** игрок проводит пальцем вниз или нажимает кнопку "Закрыть", **Then** модальное окно закрывается

---

### Edge Cases

- При пустом массиве солдат у отряда отображается сообщение "Нет данных о солдатах"
- Очень длинные названия оружия усекаются с многоточием, полный текст показывается при возможности (desktop hover или tap)
- При ошибке загрузки изображения юнита изображение скрывается, контент отображается без изображения
- При некорректных значениях характеристик (отрицательные числа, пустые строки) значение отображается красным цветом для индикации ошибки
- При быстром открытии/закрытии модального окна CSS transitions предотвращают конфликты анимации

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: Система ДОЛЖНА предоставлять возможность просмотра детальной информации о солдатах отряда без добавления отряда в армию
- **FR-002**: Система ДОЛЖНА отображать все характеристики солдата: ранг, скорость, дальность атаки (range), мощность (power), бой (melee), защита (armor), особые свойства (props)
- **FR-003**: Система ДОЛЖНА предоставлять возможность просмотра детальной информации о машинах без добавления машины в армию
- **FR-004**: Система ДОЛЖНА отображать все характеристики машины: ранг, скорострельность, максимальный боезапас, максимальная прочность, скоростные сектора, список вооружений
- **FR-005**: Система ДОЛЖНА отображать характеристики каждого оружия машины: название, дальность, мощность, особые свойства
- **FR-006**: Система ДОЛЖНА предоставлять визуально различимое отображение для отрядов (список солдат) и машин (вооружения и скоростные сектора)
- **FR-007**: Система ДОЛЖНА обеспечивать адаптивный отображение деталей для мобильных устройств (экраны <768px)
- **FR-008**: Система ДОЛЖНА обеспечивать возможность закрытия деталей по клику вне модального окна или кнопке закрытия
- **FR-009**: Система ДОЛЖНА обрабатывать ошибки загрузки изображений с отображением плейсхолдера
- **FR-010**: Система ДОЛЖНА обеспечивать touch-элементы минимум 44x44px на мобильных устройствах
- **FR-011**: Система ДОЛЖНА сохранять состояние выбора (фильтры, поиск, выбранные юниты) при открытии и закрытии деталей
- **FR-012**: Система ДОЛЖНА отображать особые свойства солдата (например, "Г" - граната) с визуальным выделением
- **FR-013**: Система ДОЛЖНА обеспечивать focus trap в модальном окне - Tab циклически переключает фокус между интерактивными элементами модального окна, клавиша Escape закрывает модальное окно
- **FR-014**: Кнопка закрытия модального окна ДОЛЖНА находиться в правом верхнем углу заголовка модального окна и оставаться видимой при прокрутке содержимого

### Key Entities

- **Soldier**: Представляет бойца в отряде с характеристиками ранг, скорость, дальность атаки, мощность, бой, защита, особые свойства, изображение
- **Squad**: Представляет отряд из 1-6 солдат с общим названием, фракцией, стоимостью и изображением
- **Weapon**: Представляет оружие машины с названием, дальностью, мощностью и особыми свойствами
- **SpeedSector**: Представляет диапазон прочности машины с соответствующей скоростью (min_durability, max_durability, speed)
- **Machine**: Представляет боевую машину с рангом, скорострельностью, боезапасом, прочностью, списком скоростных секторов и вооружений

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: Пользователь может просмотреть характеристики любого отряда за 2 клика/тапа (клик на карточку → детали отображаются)
- **SC-002**: Пользователь может просмотреть характеристики любой машины за 2 клика/тапа
- **SC-003**: Время открытия деталей юнита не превышает 300мс после клика на карточку
- **SC-004**: 100% пользователей могут найти и просмотреть характеристики солдата/машины с первой попытки без инструкций
- **SC-005**: На мобильных устройствах все характеристики отряда/машины читаемы без горизонтальной прокрутки (только вертикальная)
- **SC-006**: Модальное окно с деталями закрывается за 1 клик/тап (кнопка закрытия или клик вне окна)
- **SC-007**: При наличии 6 солдат в отряде, все они отображаются с полными характеристиками в одном просматриваемом списке (с прокруткой если необходимо)
